<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<title>Выписка</title>
<style>
@font-face {
  font-family: "DejaVuSans";
  src: url("static/DejaVuSans.ttf") format("truetype");
}
@font-face {
  font-family: "DejaVuSans";
  src: url("static/DejaVuSans-Bold.ttf") format("truetype");
  font-weight: bold;
}
@page {
  size: A4 portrait;
  margin: 8pt 0 30pt 24pt;
  @bottom-center {
    content: counter(page) " / " counter(pages);
    font-size: 8pt;
  }
}
body, table {
  font-family: "DejaVuSans", sans-serif;
  font-size: 8pt;
  line-height: 1.2;
}
h1 {
  font-size: 16pt;
  font-weight: bold;
  margin: 0;
}
.header-table {
  width: 100%;
  margin-top: 4pt;
  border-collapse: collapse;
}
.header-table td {
  padding: 0;
}
.header-table td:last-child {
  text-align: right;
  font-weight: bold;
}
.operations {
  width: 571pt;
  border-collapse: collapse;
  table-layout: fixed;
  margin-top: 10pt;
}
.operations col:nth-child(1){width:68pt;}
.operations col:nth-child(2){width:173pt;}
.operations col:nth-child(3){width:246pt;}
.operations col:nth-child(4){width:84pt;}
.operations th, .operations td {
  border: 0.5pt solid #000;
  padding: 2pt;
  vertical-align: top;
}
.operations td {
  word-break: break-word;
  overflow-wrap: anywhere;
}
.operations thead th {
  font-weight: bold;
}
.operations td:last-child {
  text-align: right;
  vertical-align: bottom;
}
footer {
  position: fixed;
  bottom: 8pt;
  left: 24pt;
  right: 0;
  font-size: 8pt;
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
}
footer .left {
  display: flex;
  gap: 5pt;
}
footer .left .text {
  display: flex;
  flex-direction: column;
}
footer .right {
  text-align: right;
}
</style>
</head>

<body>
  <div class="page">
    <img src="out001.png" alt="background image" class="background"/>
    <img src="static/logo.png" alt="Логотип" class="logo"/>

    <div class="content">
      <h1>Выписка</h1>
      <p>
        Период: {{ data.statement.period_start|date }}
        –
        {{ data.statement.period_end|date }}
      </p>

      <table class="header-table">
        <tr>
          <td colspan="2">Счёт: {{ data.account.number|account_format }}</td>
        </tr>
        <tr>
          <td>Входящий остаток на {{ data.statement.period_start|date }}</td>
          <td>{{ opening_balance|rub_format }}</td>
        </tr>
      </table>

      <table class="operations">
        <colgroup><col/><col/><col/><col/></colgroup>
        <thead>
          <tr>
            <th>Дата</th>
            <th>Плательщик / Получатель</th>
            <th>Операция</th>
            <th>Сумма (RUB)</th>
          </tr>
        </thead>
        <tbody>
          {% for t in data.transactions %}
          <tr>
            <td>{{ t.date|date }}</td>
            <td>{{ t.counterparty or '' }}</td>
            <td>{{ t.description }}</td>
            <td>{{ t.amount|rub_format }}</td>
          </tr>
          {% endfor %}
          <tr>
            <td colspan="3">Исходящий остаток на {{ data.statement.period_end|date }}</td>
            <td style="font-weight:bold;">{{ closing_balance|rub_format }}</td>
          </tr>
          <tr>
            <td colspan="2"></td>
            <td>Поступление</td>
            <td>{{ total_incoming|rub_format }}</td>
          </tr>
          <tr>
            <td colspan="2"></td>
            <td>Списание</td>
            <td>{{ total_outgoing|rub_format }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <footer>
      <div class="left">
        <div class="text">
          <div>ПАО «БАНК САНКТ-ПЕТЕРБУРГ»</div>
          <div>БИК 044030790</div>
        </div>
      </div>
      <div class="right">
        <div>{{ data.account.user.username }}</div>
        <div>{{ data.statement.created_at|format_ts }}</div>
      </div>
    </footer>
  </div>
</body>
</html>
